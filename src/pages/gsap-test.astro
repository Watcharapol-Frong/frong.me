---
import Base from "@/layouts/Base.astro";
---

<Base title="GSAP Scroll Test">
  <div class="h-[50vh] flex items-center justify-center bg-theme-light dark:bg-darkmode-theme-light">
    <p class="animate-bounce">↓ เลื่อนลงเพื่อดูเวทมนตร์ ↓</p>
  </div>

  <section class="test-container h-screen bg-white dark:bg-darkmode-body flex overflow-hidden relative border-y border-primary">
    
    <div class="w-1/2 h-full flex flex-col justify-center px-12 z-10">
      <div class="step-1 opacity-0 translate-y-10">
        <h2 class="text-4xl font-bold text-primary mb-4">Step 01: The Idea</h2>
        <p class="text-lg">จุดเริ่มต้นของโปรเจกต์คือการตั้งคำถาม...</p>
      </div>
      <div class="step-2 opacity-0 translate-y-10 absolute">
        <h2 class="text-4xl font-bold text-secondary mb-4">Step 02: Design</h2>
        <p class="text-lg">การออกแบบที่เน้น User Experience เป็นหัวใจสำคัญ</p>
      </div>
    </div>

    <div class="w-1/2 h-full flex items-center justify-center bg-primary/10">
      <div class="visual-box w-40 h-40 bg-primary rounded-xl flex items-center justify-center text-white text-6xl font-bold">
        A
      </div>
    </div>
    
  </section>

  <div class="h-screen bg-theme-light dark:bg-darkmode-theme-light flex items-center justify-center">
    <h2 class="text-2xl">จบหน้าทดสอบแล้ว</h2>
  </div>
</Base>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  // สร้าง Timeline
  const tl = gsap.timeline({
    scrollTrigger: {
      trigger: ".test-container",
      start: "top top", 
      end: "+=1500",    // ยิ่งเลขมาก ยิ่งต้องไถเมาส์นานขึ้น
      scrub: 1,         // ความนุ่มนวลในการไถ (เลขมากยิ่งนุ่ม)
      pin: true,        // ล็อกหน้าจอไว้
      markers: true,    // ช่วยให้เห็นจุด Start/End ของการไถ
    }
  });

  // ลำดับการเคลื่อนไหว
  tl.to(".step-1", { opacity: 1, y: 0, duration: 2 })
    .to(".visual-box", { rotation: 360, borderRadius: "50%", backgroundColor: "#ff5733", duration: 3 })
    .to(".step-1", { opacity: 0, y: -50, duration: 2 })
    .to(".step-2", { opacity: 1, y: 0, duration: 2 })
    .to(".visual-box", { scale: 2, innerText: "B", duration: 3 });
</script>